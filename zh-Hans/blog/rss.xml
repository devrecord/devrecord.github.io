<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Hbdoc Blog</title>
        <link>https://hbdoc.github.io/zh-Hans/blog</link>
        <description>Hbdoc Blog</description>
        <lastBuildDate>Tue, 23 May 2023 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-Hans</language>
        <item>
            <title><![CDATA[记一次GC问题排查]]></title>
            <link>https://hbdoc.github.io/zh-Hans/blog/记一次GC问题排查</link>
            <guid>https://hbdoc.github.io/zh-Hans/blog/记一次GC问题排查</guid>
            <pubDate>Tue, 23 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[应用程序开发难免遇到内存溢出，性能瓶颈问题，为了找出其中隐藏的问题就需要去分析JVM。这里使用Jdk自带工具jvisualvm来分析。]]></description>
            <content:encoded><![CDATA[<p>应用程序开发难免遇到内存溢出，性能瓶颈问题，为了找出其中隐藏的问题就需要去分析JVM。这里使用Jdk自带工具jvisualvm来分析。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="现象">现象<a href="#现象" class="hash-link" aria-label="现象的直接链接" title="现象的直接链接">​</a></h2><p>跑任务时出现了<code>GC overhead limit exceeded</code>，看到这个报错信息时大概猜测是内存不够的问题。但是具体是什么问题，还要具体分析。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">xception in thread "job任务-1" org.springframework.dao.TransientDataAccessResourceException: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Error querying database.  Cause: java.sql.SQLException: GC overhead limit exceeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### The error may exist in com/OperateRecordMapper.java (best guess)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### The error may involve defaultParameterMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### The error occurred while setting parameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### SQL: SELECT  xx,settlement_code,xx,status_1,xx_2,si_no,operate_time  FROM operate_record</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Cause: java.sql.SQLException: GC overhead limit exceeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; GC overhead limit exceeded; nested exception is java.sql.SQLException: GC overhead limit exceeded</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>由上可以看出，当查询<code>operate_record</code>表时程序报错，说明有可能是这个SQL查询数据量过大引起的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何排查">如何排查？<a href="#如何排查" class="hash-link" aria-label="如何排查？的直接链接" title="如何排查？的直接链接">​</a></h2><p>确定了方向，就可以排查了。于是就使用jvisualvm工具查看了堆内存。发现堆内存只有来2g，但却使用了1.9g。说明这个问题就是查询了大量数据占用了堆内存。于是将堆内存扩大，错误就解决了。当前这里出现的案例其实还比较简单，因为一眼能看出来是什么地方出了问题。如果增加了堆内存还是有问题，那么就需要更加详细的排查了了。</p>]]></content:encoded>
            <category>GC</category>
            <category>JVM</category>
        </item>
        <item>
            <title><![CDATA[Docker容器化部署Mysql报错]]></title>
            <link>https://hbdoc.github.io/zh-Hans/blog/Docker</link>
            <guid>https://hbdoc.github.io/zh-Hans/blog/Docker</guid>
            <pubDate>Mon, 22 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[现象]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="现象">现象<a href="#现象" class="hash-link" aria-label="现象的直接链接" title="现象的直接链接">​</a></h2><p>当使用Docker部署Mysql容器后发现容器不能启动，一直在重启。</p><p>于是使用<code>docker logs msyq容器ID</code> 查看mysql容器启动日志。发现报<code>Docker容器化部署报Fatal error Can‘t open and lock privilege tables Table ‘mysql.user‘ doesn‘t exist</code>错误。</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16 16:02:09+08:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.36-1debian10 started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16 16:02:09+08:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16 16:02:09+08:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.36-1debian10 started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.679550Z 0 [Warning] 'NO_AUTO_CREATE_USER' sql mode was not set.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.682897Z 0 [Note] mysqld (mysqld 5.7.36) starting as process 1 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688311Z 0 [Note] InnoDB: PUNCH HOLE support available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688364Z 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688373Z 0 [Note] InnoDB: Uses event mutexes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688379Z 0 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688385Z 0 [Note] InnoDB: Compressed tables use zlib 1.2.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688395Z 0 [Note] InnoDB: Using Linux native AIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.688897Z 0 [Note] InnoDB: Number of pools: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.689188Z 0 [Note] InnoDB: Using CPU crc32 instructions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.692403Z 0 [Note] InnoDB: Initializing buffer pool, total size = 128M, instances = 1, chunk size = 128M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.705963Z 0 [Note] InnoDB: Completed initialization of buffer pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.710474Z 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority().</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.724463Z 0 [Note] InnoDB: Highest supported file format is Barracuda.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.754375Z 0 [Note] InnoDB: Creating shared tablespace for temporary tables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.754777Z 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.877534Z 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.878972Z 0 [Note] InnoDB: 96 redo rollback segment(s) found. 96 redo rollback segment(s) are active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.879027Z 0 [Note] InnoDB: 32 non-redo rollback segment(s) are active.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.881070Z 0 [Note] InnoDB: 5.7.36 started; log sequence number 14792156015</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.881534Z 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.882013Z 0 [Note] InnoDB: Buffer pool(s) load completed at 230516 16:02:09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.882484Z 0 [Note] Plugin 'FEDERATED' is disabled.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysqld: Table 'mysql.plugin' doesn't exist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.882885Z 0 [ERROR] Can't open the mysql.plugin table. Please run mysql_upgrade to create it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.884129Z 0 [Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.887258Z 0 [Note] Found ca.pem, server-cert.pem and server-key.pem in data directory. Trying to enable SSL support using them.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.887321Z 0 [Note] Skipping generation of SSL certificates as certificate files are present in data directory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.887353Z 0 [Warning] A deprecated TLS version TLSv1 is enabled. Please use TLSv1.2 or higher.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.887359Z 0 [Warning] A deprecated TLS version TLSv1.1 is enabled. Please use TLSv1.2 or higher.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.889133Z 0 [Warning] CA certificate ca.pem is self signed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.889279Z 0 [Note] Skipping generation of RSA key pair as key files are present in data directory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.890926Z 0 [Note] Server hostname (bind-address): '*'; port: 3306</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.891098Z 0 [Note] IPv6 is available.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.891159Z 0 [Note]   - '::' resolves to '::';</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.891269Z 0 [Note] Server socket created on IP: '::'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.894277Z 0 [Warning] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.894885Z 0 [Warning] Failed to open optimizer cost constant tables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.895278Z 0 [ERROR] Fatal error: Can't open and lock privilege tables: Table 'mysql.user' doesn't exist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.895350Z 0 [ERROR] Fatal error: Failed to initialize ACL/grant/time zones structures or failed to remove temporary table files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-05-16T08:02:09.895572Z 0 [ERROR] Aborting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>观察有error<code>Can't open and lock privilege tables: Table 'mysql.user' doesn't exist</code>的地方，分析得到不能启动的原因是mysql权限受损。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何解决">如何解决<a href="#如何解决" class="hash-link" aria-label="如何解决的直接链接" title="如何解决的直接链接">​</a></h2><p>容器化部署的mysql，出现这个问题，再次安装部署还是没有解决。因为容器也有数据卷。如果数据不重要，可以采取清除容器卷的方式来处理。</p><ul><li><p>关闭数据库容器</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker stop 容器ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><ul><li><p>删除容器</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker rm 容器ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><ul><li>查看数据卷</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker volume ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost deploy]# docker volume ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DRIVER    VOLUME NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local     deploy_data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>删除容器卷</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker volume rm volume_name volume_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>mysql</category>
            <category>sql</category>
            <category>docusaurus</category>
            <category>docker</category>
        </item>
        <item>
            <title><![CDATA[Rpm安装Mysql问题记录]]></title>
            <link>https://hbdoc.github.io/zh-Hans/blog/Rpm安装Mysql问题记录</link>
            <guid>https://hbdoc.github.io/zh-Hans/blog/Rpm安装Mysql问题记录</guid>
            <pubDate>Wed, 22 Mar 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[安装Mysql]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装mysql">安装Mysql<a href="#安装mysql" class="hash-link" aria-label="安装Mysql的直接链接" title="安装Mysql的直接链接">​</a></h2><p>安装<code>Mysql</code>时报错，于是将一些解决方案记录下来。以下是报错信息。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]# rpm -ivh MySQL-server-5.6.24-1.el6.x86_64.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">error: Failed dependencies:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /usr/bin/perl is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        libaio.so.1()(64bit) is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        libaio.so.1(LIBAIO_0.1)(64bit) is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        libaio.so.1(LIBAIO_0.4)(64bit) is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        net-tools is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>看报错信息是<code>Mysql</code>需要<code>libaio</code>依赖，执行<code>yum install libaio</code>。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]# yum install libaio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded plugins: fastestmirror</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading mirror speeds from cached hostfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * base: mirrors.cqu.edu.cn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * extras: mirrors.cqu.edu.cn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * updates: mirrors.cqu.edu.cn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resolving Dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--&gt; Running transaction check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---&gt; Package libaio.x86_64 0:0.3.109-13.el7 will be installed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--&gt; Finished Dependency Resolution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dependencies Resolved</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Package                          Arch                             Version                                  Repository                      Size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> libaio                           x86_64                           0.3.109-13.el7                           base                            24 k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Install  1 Package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total download size: 24 k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installed size: 38 k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Is this ok [y/d/N]: y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading packages:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libaio-0.3.109-13.el7.x86_64.rpm                                                                                          |  24 kB  00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running transaction check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running transaction test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction test succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running transaction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: RPMDB altered outside of yum.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">** Found 2 pre-existing rpmdb problem(s), 'yum check' output follows:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2:postfix-2.10.1-7.el7.x86_64 has missing requires of libmysqlclient.so.18()(64bit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2:postfix-2.10.1-7.el7.x86_64 has missing requires of libmysqlclient.so.18(libmysqlclient_18)(64bit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Installing : libaio-0.3.109-13.el7.x86_64                                                                                                  1/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Verifying  : libaio-0.3.109-13.el7.x86_64                                                                                                  1/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installed:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  libaio.x86_64 0:0.3.109-13.el7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://www.huoban.com/news/post/4836.html" target="_blank" rel="noopener noreferrer"><code>libaio</code></a>已经安装成功。</p><p>执行<code> rpm -ivh MySQL-server-5.6.24-1.el6.x86_64.rpm</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">error: Failed dependencies:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /usr/bin/perl is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        net-tools is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>现在需要安装<code>per</code>。执行<code>yum install -y perl-Module-Install.noarch</code>。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]# rpm -ivh MySQL-server-5.6.24-1.el6.x86_64.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">error: Failed dependencies:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        net-tools is needed by MySQL-server-5.6.24-1.el6.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>还需要安装<code>net-tools</code>工具。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]# yum -y install net-tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded plugins: fastestmirror</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading mirror speeds from cached hostfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * base: mirrors.cqu.edu.cn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * extras: mirrors.cqu.edu.cn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * updates: mirrors.cqu.edu.cn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resolving Dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--&gt; Running transaction check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---&gt; Package net-tools.x86_64 0:2.0-0.25.20131004git.el7 will be installed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--&gt; Finished Dependency Resolution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dependencies Resolved</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Package                         Arch                         Version                                           Repository                  Size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> net-tools                       x86_64                       2.0-0.25.20131004git.el7                          base                       306 k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Install  1 Package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total download size: 306 k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installed size: 917 k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading packages:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net-tools-2.0-0.25.20131004git.el7.x86_64.rpm                                                                             | 306 kB  00:00:03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running transaction check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running transaction test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction test succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running transaction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Installing : net-tools-2.0-0.25.20131004git.el7.x86_64                                                                                     1/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Verifying  : net-tools-2.0-0.25.20131004git.el7.x86_64                                                                                     1/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installed:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  net-tools.x86_64 0:2.0-0.25.20131004git.el7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Complete!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以上报错的依赖和工具都安装好后，再次执行<code> rpm -ivh MySQL-server-5.6.24-1.el6.x86_64.rpm</code>。打开<code>/root/.mysql_secret</code>文件，查看密码。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]# cat /root/.mysql_secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The random password set for the root user at Tue Mar 21 08:29:54 2023 (local time): aLbpMlkgumg4NOD0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mysql -uroot -paLbpMlkgumg4NOD0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>启动服务</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost mysql-libs]# service mysql start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting MySQL. SUCCESS!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>登陆Mysql</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Using a password on the command line interface can be insecure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your MySQL connection id is 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server version: 5.6.24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oracle is a registered trademark of Oracle Corporation and/or its</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">affiliates. Other names may be trademarks of their respective</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">owners.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>mysql</category>
            <category>sql</category>
            <category>docusaurus</category>
        </item>
        <item>
            <title><![CDATA[Mysql连接次数过多]]></title>
            <link>https://hbdoc.github.io/zh-Hans/blog/Mysql连接次数过多</link>
            <guid>https://hbdoc.github.io/zh-Hans/blog/Mysql连接次数过多</guid>
            <pubDate>Tue, 07 Mar 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[一、发现问题]]></description>
            <content:encoded><![CDATA[<h4 class="anchor anchorWithStickyNavbar_LWe7" id="一发现问题">一、发现问题<a href="#一发现问题" class="hash-link" aria-label="一、发现问题的直接链接" title="一、发现问题的直接链接">​</a></h4><p><img loading="lazy" alt="Docusaurus Plushie" src="/zh-Hans/assets/images/8dcff919d488e530f60099102a365f3-72afd73d785b0e8a8c9c5d03fe49cd88.png" width="862" height="83" class="img_ev3q"></p><p>此时已经不能打开Mysql客户端连接数据库了。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="二永久修改">二、永久修改<a href="#二永久修改" class="hash-link" aria-label="二、永久修改的直接链接" title="二、永久修改的直接链接">​</a></h4><p>找到Linux 服务器中Mysql 中 my.cnf文件，打开并在<!-- -->[mysqld]<!-- -->下面添加一条数据</p><p><code>max_connections=1000</code> </p><p>设置完成后重启mysql即可。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="三临时修改">三、临时修改<a href="#三临时修改" class="hash-link" aria-label="三、临时修改的直接链接" title="三、临时修改的直接链接">​</a></h4><ol><li>可以使用<code>show variables like '%max_connections%';</code>查看当前数据库的连接数据</li><li>查看连接情况<code>show processlist;</code></li><li>设置<code>set GLOBAL max_connections = 1000;</code></li></ol>]]></content:encoded>
            <category>mysql</category>
            <category>sql</category>
            <category>docusaurus</category>
        </item>
    </channel>
</rss>