<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-tutorial-hadoop/hadoop之HA高可以用搭建">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Hadoop之高可用搭建 | Hbdoc</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hbdoc.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hbdoc.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hbdoc.github.io/docs/tutorial-hadoop/hadoop之HA高可以用搭建"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Hadoop之高可用搭建 | Hbdoc"><meta data-rh="true" name="description" content="在上一篇搭建集群中，我们发现NameNode只有单台节点，如果NameNode节点出现了故障那么整个集群便不可用，为了解决这个问题，Hadoop 2.0的版本便支持了NameNode 主备节点，来解决NameNode故障转移。"><meta data-rh="true" property="og:description" content="在上一篇搭建集群中，我们发现NameNode只有单台节点，如果NameNode节点出现了故障那么整个集群便不可用，为了解决这个问题，Hadoop 2.0的版本便支持了NameNode 主备节点，来解决NameNode故障转移。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hbdoc.github.io/docs/tutorial-hadoop/hadoop之HA高可以用搭建"><link data-rh="true" rel="alternate" href="https://hbdoc.github.io/docs/tutorial-hadoop/hadoop之HA高可以用搭建" hreflang="en"><link data-rh="true" rel="alternate" href="https://hbdoc.github.io/zh-Hans/docs/tutorial-hadoop/hadoop之HA高可以用搭建" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://hbdoc.github.io/docs/tutorial-hadoop/hadoop之HA高可以用搭建" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hbdoc RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hbdoc Atom Feed"><link rel="stylesheet" href="/assets/css/styles.3c6c0686.css">
<link rel="preload" href="/assets/js/runtime~main.cf3fece1.js" as="script">
<link rel="preload" href="/assets/js/main.1826c36d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Hbdoc</b></a><a class="navbar__item navbar__link" href="/docs/intro">文档</a><a class="navbar__item navbar__link" href="/blog">笔记</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">快速搭建一个博客网站</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/基础教程">基础教程</a><button aria-label="Toggle the collapsible sidebar category &#x27;基础教程&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/附加教程">附加教程</a><button aria-label="Toggle the collapsible sidebar category &#x27;附加教程&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/elasticsearch">Elasticsearch</a><button aria-label="Toggle the collapsible sidebar category &#x27;Elasticsearch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/hadoop">Hadoop</a><button aria-label="Toggle the collapsible sidebar category &#x27;Hadoop&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-hadoop/hadoop集群搭建">Hadoop集群搭建</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorial-hadoop/hadoop之HA高可以用搭建">Hadoop之高可用搭建</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/hive-">Hive </a><button aria-label="Toggle the collapsible sidebar category &#x27;Hive &#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/hadoop"><span itemprop="name">Hadoop</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Hadoop之高可用搭建</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Hadoop之高可用搭建</h1><p>在上一篇搭建集群中，我们发现<code>NameNode</code>只有单台节点，如果<code>NameNode</code>节点出现了故障那么整个集群便不可用，为了解决这个问题，Hadoop 2.0的版本便支持了<code>NameNode</code> 主备节点，来解决<code>NameNode</code>故障转移。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Prior to Hadoop 2.0.0, the NameNode was a single point of failure (SPOF) in an HDFS cluster. Each cluster had a single NameNode, and if that machine or process became unavailable, the cluster as a whole would be unavailable until the NameNode was either restarted or brought up on a separate machine.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>参考<a href="https://hadoop.apache.org/docs/r2.6.5/hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithQJM.html" target="_blank" rel="noopener noreferrer"><code>Hadoop</code>官方网站</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="服务规划">服务规划<a href="#服务规划" class="hash-link" aria-label="Direct link to 服务规划" title="Direct link to 服务规划">​</a></h2><ul><li>准备3个节点，分别是node1，node2，node3</li><li>角色分配：<code>namenode:node1,node2</code> <code>datanode：node2.node3</code>, <code>zk:node1,node2,node3</code></li><li>准备<code>zookeeper</code>安装包:<code>zookeeper-3.4.6.tar.gz</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="基础设施">基础设施<a href="#基础设施" class="hash-link" aria-label="Direct link to 基础设施" title="Direct link to 基础设施">​</a></h2><ul><li>每个节点设置免密登录</li><li>安装<code>zookeeper</code></li><li>配置<code>zookeeper</code>环境变量</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置环境变量">配置环境变量<a href="#配置环境变量" class="hash-link" aria-label="Direct link to 配置环境变量" title="Direct link to 配置环境变量">​</a></h2><p>使用如下命令配置Hadoop:</p><ul><li>传输：<code>scp ./zookeeper-3.4.6.tar.gz  node3:/opt</code>和<code>hadoop</code>,每个节点都要发送</li><li>配置<code>zookeeper</code>环境变量：/etc/profile</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">JAVA_HOME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/java/default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">HADOOP_HOME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/opt/hadoop-2.6.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ZOOKEEPER_HOME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/opt/module/zookeeper-3.4.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:#36acaa">PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token environment constant" style="color:#36acaa">$PATH</span><span class="token builtin class-name">:</span><span class="token variable" style="color:#36acaa">$JAVA_HOME</span><span class="token plain">/bin:</span><span class="token variable" style="color:#36acaa">$HADOOP_HOME</span><span class="token plain">/bin:</span><span class="token variable" style="color:#36acaa">$HADOOP_HOME</span><span class="token plain">/sbin:</span><span class="token variable" style="color:#36acaa">$ZOOKEEPER_HOME</span><span class="token plain">/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>也可以使用scp命令将profile发送到节点上。环境变量配置完后执行<code>source /etc/profile </code>生效环境变量。</p><p>分别在每台节点上执行<code>jps</code>有返回就表示环境变量配置成功。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置免密登录">配置免密登录<a href="#配置免密登录" class="hash-link" aria-label="Direct link to 配置免密登录" title="Direct link to 配置免密登录">​</a></h2><p><a href="https://hadoop.apache.org/docs/r2.6.5/hadoop-project-dist/hadoop-common/SingleCluster.html#Required_Software" target="_blank" rel="noopener noreferrer"><code>ssh must be installed and sshd must be running to use the Hadoop scripts that manage remote Hadoop daemons</code></a>.</p><p>进入root目录下，配置<code>ssh</code>前先执行<code>ssh localhost</code> 检查是否配置免密登录。</p><p><img loading="lazy" alt="Docusaurus Plushie" src="/assets/images/sshlocalhost-faacd8821646037a746c0cb08f0298ce.png" width="944" height="202" class="img_ev3q"></p><p>出现如上界面说明还没有配置免密。</p><p>根据Hadoop官网教程使用<code>ssh-keygen -t dsa -P &#x27;&#x27; -f /root/.ssh/id_dsa</code>配置免密：</p><p><img loading="lazy" alt="Docusaurus Plushie" src="/assets/images/keygen-9d0de84b4e7d2449a873dd513ab15a0b.png" width="842" height="481" class="img_ev3q"></p><p>出现<code>id_dsa,id_dsa.pub,known_hosts</code>文件说明配置成功：</p><p><img loading="lazy" alt="1678893288517" src="/assets/images/llssh-75722a7447f441c3f10446825d0df624.png" width="660" height="154" class="img_ev3q"></p><p>想哪台节点登录就需要发给那台节点：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 执行命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat id_dsa.pub &gt;&gt; authorized_keys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其他节点，<code>node2，node3</code> 也需要配置免密登录。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在node2,node3 分别执行 ssh localhost，让服务器自动创建.ssh目录，不要手动创建</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssh localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 将公钥分发到node2,node3节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@10 .ssh]# pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/root/.ssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@10 .ssh]# scp ./id_dsa.pub node2:/root/.ssh/node1.pub </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>node3</code> 也是重复`<code>node2</code>操作，但是<code> node2:/root/.ssh/</code>目录后的文件的重新命名不能重复。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scp ./id_dsa.pub node3:/root/.ssh/node1.pub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>公钥分发好后，需要在<code>/root/.ssh</code>目录下将公钥追加到<code>authorized_keys</code>，这个文件一开始是没有的，执行了追加后才有的。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在node2 上将公钥追加到authorized_keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat ./node1.pub &gt;&gt; authorized_keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在node3 上将公钥追加到authorized_keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat ./node1.pub &gt;&gt; authorized_keys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当执行<code>ssh node2 , ssh node3</code>能登录成功说明免密设置成功。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@10 .ssh]# ssh node3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last login: Fri Mar 17 23:42:23 2023 from 192.168.99.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@10 ~]#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装zookeeper">安装zookeeper<a href="#安装zookeeper" class="hash-link" aria-label="Direct link to 安装zookeeper" title="Direct link to 安装zookeeper">​</a></h2><p>将<code>zookeeper</code>包上传到服务器，并解压。找到<code>conf</code>文件夹下的 <code>zoo_sample.cfg</code> 复制并修改文件名称。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp zoo_sample.cfg zoo.cfg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>做了这步操作过后此时目录里就有<code>zoo.cfg</code>文件了，执行<code>vi zoo.cfg</code>编辑该文件。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 先配置zookeeper路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">datadir=/var/bigdata/hadoop/zk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 再配置服务节点，这里的配置是与计划安装zk的节点对应</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.1=node1:2888:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.2=node2:2888:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server.3=node3:2888:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>配置好后将<code>zk</code>分发到每个节点。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="部署配置">部署配置<a href="#部署配置" class="hash-link" aria-label="Direct link to 部署配置" title="Direct link to 部署配置">​</a></h2><p>主要是配置以下文件：</p><ul><li>core-site.xml</li><li>hdfs-site.xml</li></ul><p><strong>core-site.xml: </strong></p><p>配置<code>core-site.xml</code>以便客户端能找到<code>namenode</code>。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;configuration&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;value&gt;hdfs://node1:9000&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/configuration&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 将原来的配置改成如下方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;hdfs://mycluster&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           &lt;value&gt;node1:2181,node2:2181,node3:2181&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>hdfs-site.xml:</strong></p><p>配置<code>hdfs-site.xml</code>文件读写的副本数</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;configuration&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;value&gt;2&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # namenode原数据目录，/var/bigdata/hadoop/local/dfs/nam 不需要创建会自动创建</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;value&gt;/var/bigdata/hadoop/full/dfs/name&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # datanode 目录，/var/bigdata/hadoop/full/dfs/data不需要创建，会自动创建</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;value&gt;/var/bigdata/hadoop/full/dfs/data&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;value&gt;node2:50090&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;dfs.namenode.checkpoint.dir&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;value&gt;/var/bigdata/hadoop/full/dfs/secondary&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 将原来配置改成如下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.nameservices&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;mycluster&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.ha.namenodes.mycluster&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;nn1,nn2&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.namenode.rpc-address.mycluster.nn1&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;node1:8020&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.namenode.rpc-address.mycluster.nn2&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;node2:8020&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.namenode.http-address.mycluster.nn1&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;node1:50070&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.namenode.http-address.mycluster.nn2&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;node2:50070&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #JN在哪里启动，数据存那个磁盘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;qjournal://node1:8485;node2:8485;node3:8485/mycluster&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;/var/bigdata/hadoop/ha/dfs/jn&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #HA角色切换的代理类和实现方法，我们用的ssh免密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.client.failover.proxy.provider.mycluster&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;sshfence&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;value&gt;/root/.ssh/id_dsa&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #开启自动化： 启动zkfc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           &lt;value&gt;true&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;/property&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/configuration&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当配置好后分发每个节点。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="启动流程">启动流程<a href="#启动流程" class="hash-link" aria-label="Direct link to 启动流程" title="Direct link to 启动流程">​</a></h2><p>相信到这里已经配置好了，此时启动<code>Hadoop</code>集群要严格按照顺序启动。</p><ul><li>先启动 <code>journalnode</code>：<code>hadoop-daemon.sh start journalnode</code> `</li><li>选择一个NN 做格式化：<code>hdfs namenode -format </code>，会初始化数据。如果是生产系统，格式化只能做一次</li><li>启动这个格式化的NN ，以备另外一台同步  hadoop-daemon.sh start namenode </li><li>格式化zk：   <code>hdfs zkfc  -formatZK </code>    ，只格式化一次</li><li><code>start-dfs.sh</code></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorial-hadoop/hadoop集群搭建"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Hadoop集群搭建</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/hive-"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Hive </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#服务规划" class="table-of-contents__link toc-highlight">服务规划</a></li><li><a href="#基础设施" class="table-of-contents__link toc-highlight">基础设施</a></li><li><a href="#配置环境变量" class="table-of-contents__link toc-highlight">配置环境变量</a></li><li><a href="#配置免密登录" class="table-of-contents__link toc-highlight">配置免密登录</a></li><li><a href="#安装zookeeper" class="table-of-contents__link toc-highlight">安装zookeeper</a></li><li><a href="#部署配置" class="table-of-contents__link toc-highlight">部署配置</a></li><li><a href="#启动流程" class="table-of-contents__link toc-highlight">启动流程</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023  Hbdoc 版权所有</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cf3fece1.js"></script>
<script src="/assets/js/main.1826c36d.js"></script>
</body>
</html>